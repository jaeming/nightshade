{"version":3,"file":"bundle.js","sources":["../src/lib/template_parse.ts","../src/lib/reflection.ts","../test.reflect","../src/main.js"],"sourcesContent":["enum Bracket {\n  Open = '<',\n  End = '>',\n  Closing = '/'\n}\n\nconst BRACKETS = [Bracket.Open, Bracket.End, Bracket.Closing]\n\nenum TagState {\n  Opening = 'Opening',\n  Attributes = 'Attributes',\n  Opened = 'Opened',\n  Closing = 'Closing',\n  Closed = 'Closed'\n}\n\nexport class TemplateParse {\n  nodes = []\n  template = ''\n  buffer = ''\n  currentNode = null\n\n  constructor (template) {\n    this.template = template\n    console.log(template)\n    this.parse()\n  }\n\n  parse () {\n    for (let i = 0; i < this.template.length; i++) {\n      this.buffer = this.template[i]\n      this.process()\n    }\n  }\n\n  process () {\n    if (BRACKETS.includes(this.buffer as Bracket)) {\n      this.setBracketState()\n    } else {\n      if (this.opening) this.setTag()\n      if (this.opened) this.setText()\n    }\n  }\n\n  setBracketState () {\n    if (this.buffer === Bracket.Open) this.openTag()\n    if (this.buffer === Bracket.Closing) this.closingTag()\n    if (this.buffer === Bracket.End) this.endTag()\n  }\n\n  openTag () {\n    if (!this.currentNode) {\n      this.setRoot()\n    } else if (this.opened) {\n      this.setChild()\n    }\n  }\n\n  endTag () {\n    if (this.opening) {\n      this.setState(TagState.Opened)\n      this.nodes.push(this.currentNode)\n    }\n    if (this.closing) {\n      this.currentNode = this.findOpenParent(this.currentNode)\n    }\n  }\n\n  closingTag () {\n    this.setState(TagState.Closing)\n  }\n\n  findOpenParent (node) {\n    // find closest open parent\n    const parent = node.parent\n    // if (!parent) return node // no more parents open\n\n    return parent.state.Closed ? this.findOpenParent(node) : parent\n  }\n\n  setState (state: TagState) {\n    this.currentNode.state = state\n  }\n\n  setRoot () {\n    this.currentNode = { tag: '' }\n    this.currentNode.parent = { tag: 'ROOT', state: TagState.Opened }\n    this.setState(TagState.Opening)\n  }\n\n  setChild () {\n    const parent = this.currentNode\n    this.currentNode = { state: TagState.Opening, parent, tag: '' }\n  }\n\n  setTag () {\n    this.currentNode.tag += this.buffer\n  }\n\n  setText () {\n    // need to actually support text node instead of doing this...\n    this.currentNode.text = this.currentNode.text || ''\n    this.currentNode.text += this.buffer.replace('\\n', '')\n  }\n\n  get closing () {\n    return this.currentNode.state === TagState.Closing\n  }\n\n  get opened () {\n    return this.currentNode.state === TagState.Opened\n  }\n\n  get opening () {\n    return (\n      this.currentNode.state === TagState.Opening ||\n      this.currentNode.state === TagState.Attributes\n    )\n  }\n}\n","import { TemplateParse } from './template_parse'\n\nexport default class Reflection {\n  root = null\n\n  mount (Component, element) {\n    this.root = document.querySelector(element)\n    const component = new Component()\n    const nodes = new TemplateParse(component.template).nodes\n    console.log(nodes)\n  }\n}\n","\n  const foo = 'bar'\n\n  export default class Foo {\n  template = \"<div>\\n  Main Div here...\\n  <p>\\n    a paragraph...\\n  </p>\\n  <h3>{msg}</h3>\\n  <div>\\n    <ul>\\n      <li>item one</li>\\n      <li>item two</li>\\n    </ul>\\n  </div>\\n</div>\\n\\n\\n\"\n    msg = 'Hello World!'\n\n    sayFoo () {\n      return foo\n    }\n  }\n","import Reflection from './lib/reflection'\nimport Test from './test.reflect'\n\nconst app = new Reflection()\n\napp.mount(Test, '#app')\n"],"names":["Test"],"mappings":"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"}